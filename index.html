<!DOCTYPE html>
<html lang="en">
  <script src="https://unpkg.com/@lottiefiles/lottie-player@latest/dist/lottie-player.js"></script>
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Meetup Chat</title>

<style>
* { box-sizing: border-box; }

body {
  margin: 0;
  font-family: system-ui, -apple-system, BlinkMacSystemFont, sans-serif;
  background: #FFD6E8;
  height: 100vh;
  display: flex;
  flex-direction: column;
  padding: 12px;
}

/* TOP BAR */
.top-bar {
  display: flex;
  justify-content: flex-start;
  margin-bottom: 6px;
}

.refresh {
  background: #fff;
  border: none;
  border-radius: 50%;
  padding: 8px 10px;
  font-size: 16px;
  cursor: pointer;
}

/* CHAT AREA */
#chat {
  flex: 1;
  overflow-y: auto;
  padding: 10px;
  margin-bottom: 22vh;
}

/* MESSAGE BUBBLES */
.msg {
  max-width: 75%;
  padding: 10px 14px;
  border-radius: 16px;
  margin-bottom: 6px;
  font-size: 15px;
  animation: fadeIn .25s ease;
}

.bot {
  background: #fff;
}

.user {
  background: #DCF8C6;
  margin-left: auto;
}

/* REPLY BUTTONS */
.reply-wrap {
  display: flex;
  justify-content: flex-end;
  gap: 8px;
  margin-bottom: 14px;
}

.reply {
  background: linear-gradient(#FFB6D5, #FF8FC1);
  border: none;
  border-radius: 999px;
  padding: 8px 14px;
  font-size: 14px;
  cursor: pointer;
  box-shadow: 0 4px 0 #E07AA9;
}

.reply:active {
  transform: translateY(2px);
  box-shadow: 0 2px 0 #E07AA9;
}

/* INPUT */
.input-box {
  margin-top: 10px;
  animation: fadeIn .25s ease;
}

.input-box input {
  width: 100%;
  padding: 12px;
  border-radius: 14px;
  border: none;
  font-size: 15px;
  box-shadow: 0 4px 12px rgba(0,0,0,0.1);
  outline: none;
}

/* TYPING */
.typing {
  background: #fff;
  padding: 10px 14px;
  border-radius: 16px;
  display: inline-flex;
  gap: 4px;
  margin-bottom: 10px;
}

.dot {
  width: 6px;
  height: 6px;
  background: #999;
  border-radius: 50%;
  animation: blink 1.4s infinite both;
}

/* BUNNY */
.bunny-panel {
  position: fixed;
  bottom: 0;
  left: 50%;
  transform: translateX(-50%);
  width: 100%;
  display: flex;
  justify-content: center;
  pointer-events: none;
}

.bunny-panel img {
  height: 20vh;
  animation: bunnyBlink 6s infinite;
}

.bunny-wrap {
  animation: bunnyIdle 3s ease-in-out infinite;
}

</style>

</head>

<body>

<div class="top-bar">
  <button class="refresh" onclick="location.reload()">ðŸ”„</button>
</div>

<div id="chat"></div>

<div class="bunny-panel">
  <div class="bunny-wrap">
    <lottie-player
      id="bunny"
      src="bunny.json"
      background="transparent"
      speed="1"
      loop
      autoplay
      style="height: 20vh;">
    </lottie-player>
  </div>
</div>

<script>
const chat = document.getElementById("chat");

function bot(text) {
  const d = document.createElement("div");
  d.className = "msg bot";
  d.textContent = text;
  chat.appendChild(d);
  chat.scrollTop = chat.scrollHeight;
}

function user(text) {
  const d = document.createElement("div");
  d.className = "msg user";
  d.textContent = text;
  chat.appendChild(d);
  chat.scrollTop = chat.scrollHeight;
}

function typing(next) {
  const t = document.createElement("div");
  t.className = "typing";
  t.innerHTML = `<div class="dot"></div><div class="dot"></div><div class="dot"></div>`;
  chat.appendChild(t);
  chat.scrollTop = chat.scrollHeight;

  setTimeout(() => {
    t.remove();
    next();
  }, 900);
}

function replies(list) {
  const wrap = document.createElement("div");
  wrap.className = "reply-wrap";

  list.forEach(item => {
    const b = document.createElement("button");
    b.className = "reply";
    b.textContent = item.text;
    b.onclick = () => {
      wrap.remove();
      user(item.text);
      typing(item.next);
    };
    wrap.appendChild(b);
  });

  chat.appendChild(wrap);
}

/* CONTACT INPUT */
function contactInput(type) {
  bot(`If you feel comfortable, we can continue this on ${type}.`);

  setTimeout(() => {
    const box = document.createElement("div");
    box.className = "input-box";
    box.innerHTML = `
      <input id="contactField" placeholder="Type hereâ€¦ (only if you want)">
      <div class="reply-wrap" style="margin-top:10px">
        <button class="reply" onclick="submitContact()">Continue</button>
        <button class="reply" style="background:#eee;color:#555;box-shadow:none"
          onclick="skipContact()">Skip</button>
      </div>
    `;
    chat.appendChild(box);
    chat.scrollTop = chat.scrollHeight;
  }, 600);
}

function submitContact() {
  const field = document.getElementById("contactField");
  const value = field.value.trim();
  if (!value) return;

  field.parentElement.remove();
  user(value);

  typing(() => {
   document.getElementById("bunny").setSpeed(1.5);
   setTimeout(() => {
  document.getElementById("bunny").setSpeed(1);
}, 1000);
    bot("Nice ðŸ™‚");
    bot("That was smooth.");
    bot("Hope you have a great day.");
  });
}

function skipContact() {
  document.querySelector(".input-box").remove();
  typing(() => {
    bot("Thatâ€™s completely okay.");
    bot("Thanks for giving this a moment.");
  });
}

/* SCRIPT START */
bot("Hi thereâ€¦ this might feel a little unexpected.");
replies([
  {
    text: "Yeah ðŸ˜…",
    next: () => {
      bot("That makes sense. New moments often feel like that.");
      replies([
        {
          text: "True",
          next: () => {
            bot("How are you feeling right now?");
            replies([
              { text: "Comfortable", next: () => nextStep() },
              { text: "A bit nervous", next: () => nextStep() },
              { text: "Just curious", next: () => nextStep() }
            ]);
          }
        }
      ]);
    }
  }
]);

function nextStep() {
  bot("This actually feels nice.");
  replies([
    {
      text: "Yeah it does",
      next: () => {
        bot("Should we continue this somewhere easier?");
        replies([
          { text: "Instagram", next: () => contactInput("Instagram") },
          { text: "WhatsApp", next: () => contactInput("WhatsApp") }
        ]);
      }
    }
  ]);
}
</script>

</body>
</html>
